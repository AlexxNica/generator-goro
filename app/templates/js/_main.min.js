/* Copyright 2015 Google Inc. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *    http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

{% site "glue-boilerplate-angular" %}

{% var as glue_version %}"latest"{% endvar %}

{% if request.GET.js_debug|add:"0" %}

  {% var as args %}
    {
      "compilation_level": "WHITESPACE_ONLY",
      "formatting": ["pretty_print", "print_input_delimiter"],
      "angular_pass": true,
      "debug": true,
      "version_map": {
        "glue": "{{glue_version}}"
      }
    }
  {% endvar %}

  {% comment %}
    Allows devs to easily debug js by adding ?js_debug=1 to their goro preview
    urls and preview page with uncompiled js.
  {% endcomment %}

  if (window.console && window.console.log) {
    console.log('Debug mode enabled. Using uncompiled js.');
  }

  {% filter jscomp:args %}
    {% include "<%= projectDomain %><%= projectPath %>js/main.js" %}
  {% endfilter %}

{% else %}

  {% var as args %}
    {
      "angular_pass": true,
      "version_map": {
        "glue": "{{glue_version}}"
      }
    }
  {% endvar %}

  (function() {
    {% filter jscomp:args %}
      {% include "<%= projectDomain %><%= projectPath %>js/main.js" %}
    {% endfilter %}
  })()

{% endif %}